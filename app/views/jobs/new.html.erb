<%= javascript_include_tag "jobs" %>
<div class="container">
  <div id="new-job-page" class="form col-md-6 col-md-offset-3 white-panel clear-top" data-id="<%= @job.id %>">

    <% if !@type.nil? && @type == 0 %>
      <h1><%= t("jobs_new_category") %></h1>
    <% else %>
      <h1>
        <% if not @parent_job.nil? %>
          <%= t("jobs_new_job") %> "<%= @parent_job.title %>"
        <% else %>
          <%= t("jobs_new") %>
        <%end%>
      </h1>
    <% end %>

    <%= form_for(@job) do |f| %>
      <% if @job.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@job.errors.count, "error") %> prohibited this job from being saved:</h2>
          <ul>
            <% @job.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <% if not @parent_job.nil? %>
        <%= f.hidden_field :parent_id, value: @parent_job.id %>
      <% end %>

      <div class="form-group">
        <% if not @type.nil? %>
          <%= f.hidden_field :type, value: @type %>
        <% else %>
          <%= f.label :type, t('job_form_type') %>
          <%= f.hidden_field :type, id: "job_type", value: 1 %>
          <div class="btn-group btn-group-justified">
            <div class="btn-group">
              <button type="button" id="job_type_demand" class="btn btn-default active" onclick="setJobType(this, $('#job_type_supply'), 1);"><%=t('jobs_demand')%></button>
            </div>
            <div class="btn-group">
              <button type="button" id="job_type_supply" class="btn btn-default" onclick="setJobType(this, $('#job_type_demand'), 2);"><%=t('jobs_supply')%></button>
            </div>
          </div>
        <% end %>
      </div>
      <div class="form-group">
        <%= f.label :title, t('job_form_title') %>
        <%= f.text_field :title, class: "form-control" %>
      </div>
      <div class="area html-content form-group">
        <%= f.label :description, t('job_form_description') %>
        <%= f.resizable_text_area :description, class: "form-control", rows: "4" %>
      </div>
      <% if @type.nil? && @type != 0 %>
        <div class="form-group">
          <%= f.label :skill_list, t('job_form_tags') %>
          <br/>
          <%= f.text_field :skill_list, class: "form-control" %>
        </div>
        <div class="form-group">
          <div id="show-deadline-link">
            <%= link_to t('job_form_set_deadline'), '#',
                        :onclick => 'showDeadline()', class: "btn btn-default" %>
          </div>
          <div id="deadline-field" class="field" style="display: none;">
            <%= f.label :deadline, t('job_form_deadline') %>
            <br/>
            <%= f.text_field :deadline, class: "form-control datepicker" %>
          </div>
        </div>
        <div class="form-group">
          <div id="show-location-link">
            <%= link_to t('job_form_set_location'), '#', :onclick => 'showLocation()', class: "btn btn-default" %>
          </div>
          <div id="location-field" style="display: none;">
            <div class="form-group">
              <%= f.label :country, t('job_form_country') %>
              <br/>
              <%= f.text_field :country, class: "form-control" %>
            </div>
            <div class="form-group">
              <%= f.label :city, t('job_form_city') %>
              <br/>
              <%= f.text_field :city, class: "form-control" %>
            </div>
            <div class="form-group">
              <%= f.label :street, t('job_form_street') %>
              <br/>
              <%= f.text_field :street, class: "form-control" %>
            </div>
          </div>
        </div>
      <% else %>
        <div class="field">
          <%= f.label :picture, t('job_form_picture') %>
          <%= image_tag(@job.picture_url) if @job.picture? %>
          <%= f.file_field :picture, class: "form-control" %>
          <%= f.hidden_field :picture_cache %>
        </div>
      <% end %>
      <div class="form-group top-margin">
        <%= link_to 'Abbrechen', jobs_path, :class => "btn btn-default" %>
        <%= link_to 'Erstellen', "#", :onclick => "nicEditors.findEditor('job_description').saveContent();sendForm('new_job');return false;", :class => "btn btn-primary pull-right" %>
      </div>
    <% end %>
  </div>
</div>